---
import Profile from './Profile.astro'
import Announcement from './Announcement.astro'
import Categories from './Categories.astro'
import Tags from './Tags.astro'
import type { SidebarData } from '@contracts/content'

interface Props {
  class?: string
  sidebarData?: SidebarData
  hasRightSidebar?: boolean
}

const { class: className, sidebarData, hasRightSidebar = false } = Astro.props
const gridClass = hasRightSidebar
  ? 'md:grid-cols-[minmax(0,1fr)_minmax(0,4fr)_minmax(0,1fr)]'
  : 'md:grid-cols-[minmax(0,1fr)_minmax(0,5fr)]'
---

<div
  class={`grid w-full items-start gap-[var(--tsuki-sidebar-gap-compact)] px-0 md:gap-[var(--tsuki-sidebar-gap)] md:px-[var(--tsuki-page-inline-padding)] ${gridClass} ${className || ''}`}
>
  <aside class="order-first flex flex-col gap-[var(--tsuki-sidebar-gap-compact)] md:order-none md:gap-[var(--tsuki-sidebar-gap)]" transition:name="tsuki-sidebar" transition:animate="none">
    <Profile stats={sidebarData?.stats} />
    <Announcement />
    <Categories categories={sidebarData?.categories ?? []} />
    <Tags tags={sidebarData?.tags ?? []} />
  </aside>
  <main class="min-w-0">
    <slot />
  </main>
  {hasRightSidebar && (
    <aside class="flex flex-col gap-[var(--tsuki-sidebar-gap-compact)] md:sticky md:top-[1.5rem] md:self-start md:gap-[var(--tsuki-sidebar-gap)]" transition:name="tsuki-right-sidebar">
      <slot name="right" />
    </aside>
  )}
</div>
