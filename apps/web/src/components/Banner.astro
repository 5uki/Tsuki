---
// 横幅组件 - 首页顶部展示区域,包含标题和波浪动画
import tsukiConfig from '@/config/tsuki-config'

const titleHtml = tsukiConfig.hero?.titleHtml
const subtitleHtml = tsukiConfig.hero?.subtitleHtml
const fallbackTitle = tsukiConfig.site.title
const fallbackSubtitle = tsukiConfig.site.description
---

<section
  class="relative isolate flex h-[var(--tsuki-banner-height)] items-center justify-center overflow-hidden bg-transparent text-center [margin-top:calc(-1*var(--tsuki-header-overlap-block-size))] [padding-top:var(--tsuki-header-overlap-block-size)] [padding-bottom:var(--tsuki-banner-wave-height)] [padding-left:var(--tsuki-banner-inline-padding)] [padding-right:var(--tsuki-banner-inline-padding)] before:pointer-events-none before:absolute before:inset-0 before:z-0 before:[background-image:var(--tsuki-banner-image)] before:bg-cover before:bg-center before:bg-no-repeat before:opacity-[var(--tsuki-banner-image-opacity)] before:[filter:var(--tsuki-banner-image-filter)] before:[mask-image:var(--tsuki-banner-image-mask)] before:[mask-size:100%_100%] before:[mask-repeat:no-repeat] before:[-webkit-mask-image:var(--tsuki-banner-image-mask)] before:[-webkit-mask-size:100%_100%] before:[-webkit-mask-repeat:no-repeat] max-sm:px-[var(--tsuki-banner-inline-padding-mobile)]"
  aria-label="Banner"
>
  <div class="relative z-[1] w-[min(100%,var(--tsuki-banner-content-max-width))] p-0">
    {titleHtml ? (
      <h1
        class="m-0 mb-[var(--tsuki-banner-title-gap)] text-[var(--tsuki-banner-title-size)] font-bold leading-[1.08] text-[var(--tsuki-banner-title-fg)] tracking-[-0.02em] [text-shadow:var(--tsuki-shadow-banner-title)]"
        set:html={titleHtml}
      ></h1>
    ) : (
      <h1 class="m-0 mb-[var(--tsuki-banner-title-gap)] text-[var(--tsuki-banner-title-size)] font-bold leading-[1.08] text-[var(--tsuki-banner-title-fg)] tracking-[-0.02em] [text-shadow:var(--tsuki-shadow-banner-title)]">
        {fallbackTitle}
      </h1>
    )}

    {subtitleHtml ? (
      <p class="m-0 text-[var(--tsuki-banner-subtitle-size)] font-normal leading-[1.65] text-[var(--tsuki-banner-subtitle-fg)] [text-shadow:var(--tsuki-shadow-banner-subtitle)]" set:html={subtitleHtml}></p>
    ) : (
      <p class="m-0 text-[var(--tsuki-banner-subtitle-size)] font-normal leading-[1.65] text-[var(--tsuki-banner-subtitle-fg)] [text-shadow:var(--tsuki-shadow-banner-subtitle)]">
        {fallbackSubtitle}
      </p>
    )}
  </div>

  <div
    id="header-waves"
    class="absolute inset-x-0 bottom-[-1px] z-[5] h-[var(--tsuki-banner-wave-height)] max-h-[var(--tsuki-banner-wave-max-height)] min-h-[var(--tsuki-banner-wave-min-height)] overflow-visible opacity-90 mix-blend-soft-light [contain:none] [filter:blur(0.3px)] [mask-image:linear-gradient(to_top,var(--tsuki-mask-clear)_0%,var(--tsuki-mask-soft)_22%,var(--tsuki-mask-opaque)_55%,var(--tsuki-mask-opaque)_100%)] [mask-size:100%_100%] [mask-repeat:no-repeat] [margin-bottom:-1px] [transform:translateZ(0)] [-webkit-mask-image:linear-gradient(to_top,var(--tsuki-mask-clear)_0%,var(--tsuki-mask-soft)_22%,var(--tsuki-mask-opaque)_55%,var(--tsuki-mask-opaque)_100%)] [-webkit-mask-size:100%_100%] [-webkit-mask-repeat:no-repeat] pointer-events-none will-change-transform md:h-[var(--tsuki-banner-wave-height-md)]"
    aria-hidden="true"
  >
    <svg
      class="block h-full w-full"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      viewBox="0 24 150 28"
      preserveAspectRatio="none"
      shape-rendering="geometricPrecision"
    >
      <defs>
        <path
          id="gentle-wave"
          d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v48h-352z"
        ></path>
        <linearGradient id="tsuki-banner-wave-gradient" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stop-color="var(--tsuki-banner-wave-top, var(--tsuki-banner-wave-fill))"></stop>
          <stop offset="100%" stop-color="var(--tsuki-banner-wave-bottom, var(--tsuki-banner-wave-fill))"></stop>
        </linearGradient>
      </defs>
      <g class="parallax">
        <use xlink:href="#gentle-wave" x="48" y="0" opacity="0.35" class="fill-[url(#tsuki-banner-wave-gradient)]">
          <animateTransform
            attributeName="transform"
            type="translate"
            from="-90 0"
            to="85 0"
            dur="7s"
            repeatCount="indefinite"
            begin="-2s"
            calcMode="spline"
            keySplines="0.5 0.5 0.45 0.5"
            keyTimes="0;1"
          />
        </use>
        <use xlink:href="#gentle-wave" x="48" y="3" opacity="0.6" class="fill-[url(#tsuki-banner-wave-gradient)]">
          <animateTransform
            attributeName="transform"
            type="translate"
            from="-90 0"
            to="85 0"
            dur="10s"
            repeatCount="indefinite"
            begin="-3s"
            calcMode="spline"
            keySplines="0.5 0.5 0.45 0.5"
            keyTimes="0;1"
          />
        </use>
        <use xlink:href="#gentle-wave" x="48" y="5" opacity="0.78" class="fill-[url(#tsuki-banner-wave-gradient)]">
          <animateTransform
            attributeName="transform"
            type="translate"
            from="-90 0"
            to="85 0"
            dur="13s"
            repeatCount="indefinite"
            begin="-4s"
            calcMode="spline"
            keySplines="0.5 0.5 0.45 0.5"
            keyTimes="0;1"
          />
        </use>
        <use xlink:href="#gentle-wave" x="48" y="7" opacity="0.92" class="fill-[url(#tsuki-banner-wave-gradient)]">
          <animateTransform
            attributeName="transform"
            type="translate"
            from="-90 0"
            to="85 0"
            dur="20s"
            repeatCount="indefinite"
            begin="-5s"
            calcMode="spline"
            keySplines="0.5 0.5 0.45 0.5"
            keyTimes="0;1"
          />
        </use>
      </g>
    </svg>
  </div>
</section>

<style>
  @media (prefers-reduced-motion: reduce) {
    #header-waves animateTransform {
      dur: 0s;
    }
  }
</style>
