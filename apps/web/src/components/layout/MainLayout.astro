---
import Profile from '../sidebar/Profile.astro'
import Announcement from '../sidebar/Announcement.astro'
import SidebarList from '../sidebar/SidebarList.astro'
import Tags from '../sidebar/Tags.astro'
import type { SidebarData } from '@/lib/types/content'

interface Props {
  class?: string
  sidebarData?: SidebarData
}

const { class: className, sidebarData } = Astro.props
---

<div class:list={['tsuki-main-grid', className]}>
  <aside class="left-sidebar">
    <Profile stats={sidebarData?.stats} />
    <Announcement />
    <SidebarList title="分类" items={sidebarData?.categories ?? []} queryKey="category" />
    <Tags tags={sidebarData?.tags ?? []} />
  </aside>
  <main class="main-content" id="swup">
    <div class="transition-main">
      <slot />
    </div>
  </main>
  <aside class="right-sidebar" id="swup-right">
    <slot name="right" />
  </aside>
</div>

<style>
  .tsuki-main-grid {
    display: grid;
    width: 100%;
    align-items: start;
    gap: var(--tsuki-sidebar-gap-compact);
  }

  @media (min-width: 768px) {
    .tsuki-main-grid {
      gap: var(--tsuki-sidebar-gap);
      grid-template-columns: 1fr 1fr 3fr 1fr 1fr;
    }
  }

  .left-sidebar {
    display: flex;
    flex-direction: column;
    gap: var(--tsuki-sidebar-gap-compact);
    order: -1;
  }
  @media (min-width: 768px) {
    .left-sidebar {
      order: 0;
      grid-column: 2;
      gap: var(--tsuki-sidebar-gap);
    }
  }

  .main-content {
    min-width: 0;
  }
  @media (min-width: 768px) {
    .main-content {
      grid-column: 3;
    }
  }

  .right-sidebar {
    display: flex;
    flex-direction: column;
    gap: var(--tsuki-sidebar-gap-compact);
  }
  @media (min-width: 768px) {
    .right-sidebar {
      grid-column: 4;
      align-self: stretch;
      gap: var(--tsuki-sidebar-gap);
    }
  }
</style>
