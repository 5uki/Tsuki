---
import tsukiConfig from '@/config/tsuki-config'

const { announcement } = tsukiConfig
const isExternalLink = (url?: string) => !!url && /^https?:\/\//i.test(url)
---

{announcement?.enable && (
  <div class="flex flex-col rounded-[var(--tsuki-sidebar-card-radius)] border border-[var(--tsuki-sidebar-card-border)] bg-[var(--tsuki-sidebar-card-bg)] p-[var(--tsuki-sidebar-card-padding)] shadow-[var(--tsuki-sidebar-card-shadow)] transition-[transform,box-shadow,border-color] duration-[140ms] ease-out hover:translate-y-[var(--tsuki-sidebar-card-hover-translate)] hover:border-[var(--tsuki-sidebar-card-border-hover)] hover:shadow-[var(--tsuki-sidebar-card-shadow-hover)] max-sm:p-[var(--tsuki-sidebar-card-padding-compact)]">
    {announcement.title && (
      <h3 class="mb-3 flex items-center gap-2 text-[var(--tsuki-text-lg)] font-semibold text-[var(--tsuki-fg)] before:h-4 before:w-1 before:rounded-[var(--tsuki-radius-2xs)] before:bg-[var(--tsuki-theme-accent)] before:content-[''] max-sm:text-[var(--tsuki-text-md)]">
        {announcement.title}
      </h3>
    )}
    {announcement.content && (
      <div
        class="mb-3 text-[var(--tsuki-text-base)] leading-[1.6] text-[var(--tsuki-fg)] [&_p]:mb-2 [&_p:last-child]:mb-0 max-sm:text-[var(--tsuki-text-sm)]"
        set:html={announcement.content}
      />
    )}
    {announcement.link?.enable && announcement.link.url && (
      <a
        href={announcement.link.url}
        target={isExternalLink(announcement.link.url) ? '_blank' : undefined}
        rel={isExternalLink(announcement.link.url) ? 'noopener noreferrer' : undefined}
        class="mt-auto inline-flex items-center self-end rounded-[var(--tsuki-radius-md)] bg-[var(--tsuki-theme-accent)] px-[0.9rem] py-[0.35rem] text-[var(--tsuki-text-sm)] font-medium text-[var(--tsuki-color-on-primary)] transition-[opacity,transform] duration-150 ease-out hover:-translate-y-[1px] hover:opacity-90"
      >
        {announcement.link.text || '查看详情'}
      </a>
    )}
  </div>
)}
