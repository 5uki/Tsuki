---
import Default from '@/layouts/Default.astro'
import tsukiConfig from '@/config/tsuki-config'

export const prerender = true

const friends = tsukiConfig.friends ?? []
---

<Default title="友链" description="我的朋友们">
  <div class="tsuki-content-card friends-page">
    <h1 class="friends-title">友链</h1>
    {friends.length > 0 ? (
      <div class="friends-grid">
        {friends.map((friend) => (
          <a
            href={friend.url}
            target="_blank"
            rel="noopener noreferrer"
            class="friend-card"
          >
            <div class="friend-avatar-wrap">
              {friend.avatar ? (
                <img
                  src={friend.avatar}
                  alt={friend.name}
                  class="friend-avatar"
                  loading="lazy"
                  decoding="async"
                />
              ) : (
                <span class="friend-avatar-fallback">
                  {friend.name.slice(0, 1).toUpperCase()}
                </span>
              )}
            </div>
            <div class="friend-info">
              <span class="friend-name">{friend.name}</span>
              {friend.description && (
                <span class="friend-desc">{friend.description}</span>
              )}
            </div>
          </a>
        ))}
      </div>
    ) : (
      <p class="tsuki-empty-state">暂无友链</p>
    )}
  </div>
</Default>

<style>
  .friends-title {
    margin-bottom: var(--tsuki-space-2xl);
    padding-bottom: var(--tsuki-space-lg);
    border-bottom: 1px solid var(--tsuki-surface-border);
    font-size: var(--tsuki-text-3xl);
    font-weight: 600;
    line-height: var(--tsuki-line-height-heading);
    color: var(--tsuki-fg);
  }

  .friends-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--tsuki-space-lg);
  }
  @media (min-width: 480px) {
    .friends-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
  @media (min-width: 1024px) {
    .friends-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  .friend-card {
    display: flex;
    align-items: center;
    gap: var(--tsuki-space-md);
    padding: var(--tsuki-space-lg);
    border-radius: var(--tsuki-radius-lg);
    border: 1px solid var(--tsuki-surface-border);
    background: var(--tsuki-sidebar-card-bg);
    text-decoration: none;
    transition:
      transform var(--tsuki-motion-card) var(--tsuki-motion-card-ease),
      box-shadow var(--tsuki-motion-card) var(--tsuki-motion-ease-out),
      border-color var(--tsuki-motion-card) var(--tsuki-motion-ease-out);
  }
  .friend-card:hover {
    transform: translateY(var(--tsuki-sidebar-card-hover-translate));
    border-color: var(--tsuki-sidebar-card-border-hover);
    box-shadow: var(--tsuki-sidebar-card-shadow-hover);
  }

  .friend-avatar-wrap {
    flex-shrink: 0;
    width: 3rem;
    height: 3rem;
    border-radius: var(--tsuki-radius-md);
    overflow: hidden;
  }

  .friend-avatar {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .friend-avatar-fallback {
    display: flex;
    width: 100%;
    height: 100%;
    align-items: center;
    justify-content: center;
    background: var(--tsuki-surface-accent);
    color: var(--tsuki-theme-accent);
    font-size: var(--tsuki-text-lg);
    font-weight: 600;
  }

  .friend-info {
    display: flex;
    flex-direction: column;
    gap: var(--tsuki-space-2xs);
    min-width: 0;
  }

  .friend-name {
    font-size: var(--tsuki-text-base);
    font-weight: 600;
    color: var(--tsuki-fg);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .friend-desc {
    font-size: var(--tsuki-text-sm);
    color: var(--tsuki-muted-fg);
    line-height: var(--tsuki-line-height-snug);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
