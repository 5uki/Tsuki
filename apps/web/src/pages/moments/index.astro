---
import Default from '@/layouts/Default.astro'
import { createAppContext } from '@entry/index'
import { getMoments } from '@usecases/content'

const ctx = createAppContext()
const moments = await getMoments(ctx)
---

<Default title="动态" description="动态时间线">
  <section class="page-section" transition:name="page-card">
    <h1 class="tsuki-page-title">动态</h1>
    {moments.length > 0 ? (
      <div class="tsuki-card-list">
        {moments.map((moment) => (
          <a href={`/moments/${moment.id}`} class="moment-card">
            <span class="moment-title">{moment.frontmatter.title}</span>
            <time class="moment-time">
              {moment.frontmatter.publishedAt}
            </time>
          </a>
        ))}
      </div>
    ) : (
      <p class="tsuki-empty-state">暂无动态</p>
    )}
  </section>
</Default>

<style>
  .page-section {
    margin-bottom: var(--tsuki-space-2);
  }

  .moment-card {
    display: flex;
    flex-direction: column;
    gap: var(--tsuki-space-0-5);
    border-radius: var(--tsuki-sidebar-card-radius);
    border: 1px solid var(--tsuki-sidebar-card-border);
    background: var(--tsuki-sidebar-card-bg);
    padding: var(--tsuki-space-1) var(--tsuki-space-1-25);
    color: var(--tsuki-fg);
    text-decoration: none;
    box-shadow: var(--tsuki-sidebar-card-shadow);
    transition:
      transform var(--tsuki-motion-card-transform-duration) var(--tsuki-motion-card-transform-ease),
      box-shadow var(--tsuki-motion-card-shadow-duration) var(--tsuki-motion-ease-out),
      border-color var(--tsuki-motion-card-border-duration) var(--tsuki-motion-ease-out);
  }
  .moment-card:hover {
    transform: translateY(var(--tsuki-sidebar-card-hover-translate));
    border-color: var(--tsuki-sidebar-card-border-hover);
    box-shadow: var(--tsuki-sidebar-card-shadow-hover);
  }

  .moment-title {
    font-size: var(--tsuki-text-lg);
    font-weight: 600;
  }

  .moment-time {
    font-size: var(--tsuki-text-sm);
    color: var(--tsuki-post-muted-fg);
  }
</style>
